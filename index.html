<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ìŠ¬ê¸°ë¡œìš´ ì…ì°°ìƒí™œ - wise-bid</title>
    <link href="https://cdn.jsdelivr.net/npm/pretendard@1.3.9/dist/web/variable/pretendardvariable.min.css" rel="stylesheet">
    <style>
        :root {
            --primary: #1a365d;
            --primary-light: #2c5282;
            --accent: #ed8936;
            --accent-hover: #dd6b20;
            --bg-main: #f7fafc;
            --bg-card: #ffffff;
            --text-main: #1a202c;
            --text-secondary: #4a5568;
            --text-muted: #718096;
            --border: #e2e8f0;
            --not-color: #e53e3e;
            --but-color: #3182ce;
            --because-color: #38a169;
            --shadow: 0 4px 20px rgba(0,0,0,0.08);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Pretendard Variable', -apple-system, sans-serif;
            background: var(--bg-main);
            color: var(--text-main);
            min-height: 100vh;
            line-height: 1.6;
        }

        header {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 1.5rem;
            text-align: center;
        }

        header h1 { font-size: 1.8rem; font-weight: 700; margin-bottom: 0.3rem; }
        header p { font-size: 1rem; opacity: 0.9; }

        .n2b-badge { display: inline-flex; gap: 0.4rem; margin-top: 0.8rem; }
        .n2b-badge span { padding: 0.2rem 0.6rem; border-radius: 15px; font-size: 0.8rem; font-weight: 600; }
        .badge-not { background: var(--not-color); }
        .badge-but { background: var(--but-color); }
        .badge-because { background: var(--because-color); }

        nav {
            background: var(--bg-card);
            border-bottom: 1px solid var(--border);
            padding: 0.5rem;
            display: flex;
            justify-content: center;
            gap: 0.3rem;
            flex-wrap: wrap;
        }

        nav button {
            padding: 0.6rem 1rem;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            font-size: 0.9rem;
            font-weight: 500;
            cursor: pointer;
            border-radius: 8px;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        nav button:hover { background: var(--bg-main); }
        nav button.active { background: var(--primary); color: white; }

        main { max-width: 900px; margin: 0 auto; padding: 1.5rem; }

        .section { display: none; animation: fadeIn 0.3s ease; }
        .section.active { display: block; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .card {
            background: var(--bg-card);
            border-radius: 16px;
            padding: 1.5rem;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
            border: 1px solid var(--border);
        }

        .card h2 {
            font-size: 1.3rem;
            color: var(--primary);
            margin-bottom: 0.5rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .card > p { color: var(--text-muted); margin-bottom: 1.2rem; font-size: 0.95rem; }

        .form-group { margin-bottom: 1.2rem; }
        .form-group label { display: block; font-weight: 600; margin-bottom: 0.4rem; }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 0.8rem 1rem;
            border: 2px solid var(--border);
            border-radius: 10px;
            font-size: 1rem;
            font-family: inherit;
        }

        .form-group input:focus,
        .form-group select:focus { outline: none; border-color: var(--primary); }

        .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; }
        .form-row-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 1rem; }

        /* ìŠ¬ë¼ì´ë” ìŠ¤íƒ€ì¼ */
        .slider-group { margin-bottom: 1.5rem; }
        .slider-group label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 0.5rem;
        }
        .slider-value {
            background: var(--primary);
            color: white;
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        input[type="range"] {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #e2e8f0;
            outline: none;
            -webkit-appearance: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: var(--accent);
            cursor: pointer;
            box-shadow: 0 2px 6px rgba(0,0,0,0.2);
        }

        .btn {
            padding: 0.9rem 1.8rem;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .btn-primary { background: var(--accent); color: white; }
        .btn-primary:hover { background: var(--accent-hover); transform: translateY(-2px); }
        .btn-primary:disabled { background: #ccc; cursor: not-allowed; }

        .btn-secondary { background: var(--bg-main); color: var(--text-main); border: 2px solid var(--border); }
        .btn-secondary:hover { border-color: var(--primary); }

        .btn-group { display: flex; gap: 1rem; margin-top: 1rem; flex-wrap: wrap; }

        /* ê²°ê³¼ ë°•ìŠ¤ */
        .result-box {
            background: linear-gradient(135deg, #f0fff4 0%, #e6fffa 100%);
            border: 2px solid var(--because-color);
            border-radius: 12px;
            padding: 1.5rem;
            margin-top: 1.5rem;
            display: none;
        }

        .result-box.show { display: block; animation: slideUp 0.4s ease; }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-box h3 {
            color: var(--because-color);
            margin-bottom: 1rem;
            font-size: 1.1rem;
        }

        /* ë¹„ìš© í…Œì´ë¸” */
        .cost-table {
            width: 100%;
            border-collapse: collapse;
            margin: 1rem 0;
        }

        .cost-table th, .cost-table td {
            padding: 0.8rem;
            text-align: right;
            border-bottom: 1px solid var(--border);
        }

        .cost-table th { text-align: left; font-weight: 600; background: #f8fafc; }
        .cost-table th:first-child { border-radius: 8px 0 0 0; }
        .cost-table th:last-child { border-radius: 0 8px 0 0; }

        .cost-table .total { font-weight: 700; background: #f0fff4; }
        .cost-table .saving { color: var(--because-color); font-weight: 600; }

        /* N2B ê²°ê³¼ */
        .n2b-result {
            background: white;
            border-radius: 12px;
            padding: 1.2rem;
            margin: 1rem 0;
        }

        .n2b-item {
            display: flex;
            gap: 1rem;
            margin-bottom: 0.8rem;
            align-items: flex-start;
        }

        .n2b-label {
            min-width: 80px;
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            font-weight: 700;
            color: white;
            text-align: center;
            font-size: 0.85rem;
        }

        .n2b-label.not { background: var(--not-color); }
        .n2b-label.but { background: var(--but-color); }
        .n2b-label.because { background: var(--because-color); }

        .n2b-text { flex: 1; padding-top: 0.3rem; }

        /* íŒì • ê²°ê³¼ */
        .decision-result {
            text-align: center;
            padding: 1.5rem;
            border-radius: 12px;
            margin: 1rem 0;
        }

        .decision-result.positive { background: linear-gradient(135deg, #c6f6d5 0%, #9ae6b4 100%); }
        .decision-result.neutral { background: linear-gradient(135deg, #feebc8 0%, #fbd38d 100%); }
        .decision-result.negative { background: linear-gradient(135deg, #fed7d7 0%, #feb2b2 100%); }

        .decision-score {
            font-size: 3rem;
            font-weight: 800;
            margin-bottom: 0.3rem;
        }

        .decision-label {
            font-size: 1.4rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
        }

        .decision-desc { color: var(--text-secondary); }

        /* íˆ¬ì°° ì „ëµ */
        .strategy-box {
            background: linear-gradient(135deg, #ebf8ff 0%, #bee3f8 100%);
            border: 2px solid var(--but-color);
            border-radius: 12px;
            padding: 1.2rem;
            margin: 1rem 0;
        }

        .strategy-box h4 { color: var(--but-color); margin-bottom: 0.8rem; }

        .strategy-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            text-align: center;
        }

        .strategy-item {
            background: white;
            border-radius: 8px;
            padding: 1rem;
        }

        .strategy-item .value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary);
        }

        .strategy-item .label {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        /* í™ˆ ê·¸ë¦¬ë“œ */
        .home-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 1rem;
        }

        .home-card {
            background: var(--bg-card);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid var(--border);
        }

        .home-card:hover {
            transform: translateY(-5px);
            border-color: var(--accent);
            box-shadow: var(--shadow);
        }

        .home-card .icon { font-size: 2.5rem; margin-bottom: 0.5rem; }
        .home-card h3 { font-size: 1.1rem; color: var(--primary); margin-bottom: 0.3rem; }
        .home-card p { font-size: 0.85rem; color: var(--text-muted); }

        /* ë¡œë”© */
        .loading { display: none; text-align: center; padding: 2rem; }
        .loading.show { display: block; }
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid var(--border);
            border-top-color: var(--accent);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }
        @keyframes spin { to { transform: rotate(360deg); } }

        /* ê³µì¢… ì¹´ë“œ */
        .work-type-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 0.5rem;
            margin-bottom: 1rem;
        }

        .work-type-btn {
            padding: 0.8rem 0.5rem;
            border: 2px solid var(--border);
            border-radius: 8px;
            background: white;
            cursor: pointer;
            text-align: center;
            transition: all 0.2s;
            font-family: inherit;
            font-size: 0.85rem;
        }

        .work-type-btn:hover { border-color: var(--primary); }
        .work-type-btn.selected {
            border-color: var(--accent);
            background: #fff5eb;
        }

        .work-type-btn .emoji { font-size: 1.5rem; display: block; margin-bottom: 0.3rem; }

        /* ì¸í¬ë°•ìŠ¤ */
        .info-box {
            background: linear-gradient(135deg, #ebf8ff 0%, #e6fffa 100%);
            border-left: 4px solid var(--but-color);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 1.5rem;
        }

        .info-box h4 { color: var(--but-color); margin-bottom: 0.5rem; }

        @media (max-width: 768px) {
            header h1 { font-size: 1.5rem; }
            main { padding: 1rem; }
            .form-row, .form-row-3 { grid-template-columns: 1fr; }
            .strategy-grid { grid-template-columns: 1fr; }
            .home-grid { grid-template-columns: 1fr; }
            .work-type-grid { grid-template-columns: repeat(3, 1fr); }
            nav button { padding: 0.5rem 0.7rem; font-size: 0.8rem; }
            .profile-grid { grid-template-columns: 1fr; }
        }

        /* í”„ë¡œí•„ ì„ íƒ ê·¸ë¦¬ë“œ */
        .profile-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            margin-top: 0.5rem;
        }

        .profile-btn {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 1rem;
            border: 2px solid var(--border);
            border-radius: 12px;
            background: white;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .profile-btn:hover {
            border-color: var(--primary-light);
            background: #f7fafc;
        }

        .profile-btn.selected {
            border-color: var(--accent);
            background: #fff5eb;
        }

        .profile-icon { font-size: 2rem; margin-bottom: 0.5rem; }
        .profile-name { font-weight: 600; color: var(--primary); margin-bottom: 0.3rem; }
        .profile-desc { font-size: 0.8rem; color: var(--text-muted); text-align: center; }

        /* ì§€ì—­ ì„ íƒ ê·¸ë¦¬ë“œ */
        .region-grid {
            display: grid;
            grid-template-columns: repeat(6, 1fr);
            gap: 0.5rem;
            margin-top: 0.5rem;
        }

        .checkbox-label {
            display: flex;
            align-items: center;
            gap: 0.3rem;
            padding: 0.4rem 0.6rem;
            border: 1px solid var(--border);
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            transition: all 0.2s;
        }

        .checkbox-label:hover {
            background: #f7fafc;
        }

        .checkbox-label input:checked + span,
        .checkbox-label:has(input:checked) {
            background: #ebf8ff;
            border-color: var(--primary-light);
        }

        .full-width {
            width: 100%;
        }

        small {
            color: var(--text-muted);
            font-size: 0.75rem;
        }

        @media (max-width: 768px) {
            .region-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* ë§¤ì¹­ ê²°ê³¼ */
        .match-summary {
            background: linear-gradient(135deg, #e6fffa 0%, #ebf8ff 100%);
            border-radius: 12px;
            padding: 1rem;
            margin-bottom: 1rem;
            display: flex;
            justify-content: space-around;
            text-align: center;
        }

        .match-stat {
            padding: 0.5rem;
        }

        .match-stat .value {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary);
        }

        .match-stat .label {
            font-size: 0.85rem;
            color: var(--text-muted);
        }

        .match-list {
            max-height: 500px;
            overflow-y: auto;
        }

        .match-item {
            border: 1px solid var(--border);
            border-radius: 10px;
            padding: 1rem;
            margin-bottom: 0.8rem;
            transition: all 0.3s ease;
        }

        .match-item:hover {
            border-color: var(--primary-light);
            box-shadow: var(--shadow);
        }

        .match-item-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 0.5rem;
        }

        .match-item-title {
            font-weight: 600;
            color: var(--primary);
            flex: 1;
            margin-right: 1rem;
        }

        .match-score {
            background: var(--accent);
            color: white;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .match-score.high { background: var(--because-color); }
        .match-score.medium { background: var(--accent); }
        .match-score.low { background: var(--text-muted); }

        .match-item-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.5rem;
            font-size: 0.9rem;
            color: var(--text-secondary);
            margin-bottom: 0.5rem;
        }

        .match-reasons {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .match-reason {
            background: #e6fffa;
            color: var(--because-color);
            padding: 0.2rem 0.6rem;
            border-radius: 12px;
            font-size: 0.75rem;
        }

        .match-item-actions {
            margin-top: 0.8rem;
            display: flex;
            gap: 0.5rem;
        }

        .match-item-actions button {
            flex: 1;
            padding: 0.5rem;
            font-size: 0.85rem;
        }

        /* ìŠ¬ë¡œê±´ ë°•ìŠ¤ */
        .slogan-box {
            background: linear-gradient(135deg, var(--primary) 0%, var(--primary-light) 100%);
            color: white;
            padding: 2rem;
            border-radius: 16px;
            text-align: center;
            margin-bottom: 1.5rem;
            box-shadow: var(--shadow);
        }

        .slogan-text p {
            font-size: 1.3rem;
            margin: 0.3rem 0;
            opacity: 0.95;
        }

        .slogan-text p:last-child {
            font-size: 1.5rem;
            margin-top: 0.5rem;
        }

        .slogan-text strong {
            color: var(--accent);
        }
    </style>
</head>
<body>
    <header>
        <h1>ğŸ›ï¸ ìŠ¬ê¸°ë¡œìš´ ì…ì°°ìƒí™œ</h1>
        <p>ê²½ìŸê°€ ê¸°ë°˜ N2B ì˜ì‚¬ê²°ì •</p>
        <div class="n2b-badge">
            <span class="badge-not">Not</span>
            <span class="badge-but">But</span>
            <span class="badge-because">Because</span>
        </div>
    </header>

    <nav>
        <button class="active" onclick="showSection('home', this)">ğŸ  í™ˆ</button>
        <button onclick="showSection('match', this)">ğŸ¯ ê³µê³ ë§¤ì¹­</button>
        <button onclick="showSection('cost', this)">ğŸ“Š ê²½ìŸê°€ë¶„ì„</button>
    </nav>

    <main>
        <!-- Home Section -->
        <section id="home" class="section active">
            <!-- ë©”ì¸ ìŠ¬ë¡œê±´ -->
            <div class="slogan-box">
                <div class="slogan-text">
                    <p>ê²½ìŸê°€ë¥¼ ì•Œì•„ì•¼</p>
                    <p>ë‚´ ê²½ìŸë ¥ì„ ì•Œê³ </p>
                    <p><strong>ì´ê¸¸ ìˆ˜ ìˆëŠ” ê²½ìŸì„ í•œë‹¤</strong></p>
                </div>
            </div>

            <div class="home-grid">
                <div class="home-card" onclick="showSection('match')">
                    <div class="icon">ğŸ¯</div>
                    <h3>ê³µê³ ë§¤ì¹­</h3>
                    <p>íšŒì‚¬ ë§ì¶¤í˜•<br>ì…ì°°ê³µê³  ì¶”ì²œ</p>
                </div>

                <div class="home-card" onclick="showSection('cost')">
                    <div class="icon">ğŸ“Š</div>
                    <h3>ê²½ìŸê°€ ë¶„ì„</h3>
                    <p>ê²½ìŸê°€ vs ë‚´ ì›ê°€<br>N2B íŒì •</p>
                </div>
            </div>

            <!-- N2B íŒì • ê°€ì´ë“œ -->
            <div class="card" style="margin-top: 1.5rem;">
                <h2>ğŸ¯ N2B ê²½ìŸë ¥ íŒì •</h2>
                <p>ê²½ìŸê°€ ëŒ€ë¹„ ë‚´ ì›ê°€ë¡œ ì°¸ì—¬ ì—¬ë¶€ë¥¼ ê²°ì •í•©ë‹ˆë‹¤.</p>
                <table class="cost-table">
                    <tr>
                        <th>íŒì •</th>
                        <th>ì¡°ê±´</th>
                        <th>ì˜ë¯¸</th>
                        <th>ê²°ì •</th>
                    </tr>
                    <tr style="background: #fee2e2;">
                        <td><strong style="color: var(--not-color);">Not</strong></td>
                        <td>ê²½ìŸê°€ &lt; ë‚´ ì›ê°€</td>
                        <td>ê²½ìŸë ¥ ì—†ìŒ</td>
                        <td>âŒ í¬ê¸°</td>
                    </tr>
                    <tr style="background: #dbeafe;">
                        <td><strong style="color: var(--but-color);">But</strong></td>
                        <td>ê²½ìŸê°€ â‰ˆ ë‚´ ì›ê°€</td>
                        <td>ê²½ìŸë ¥ ë³´í†µ</td>
                        <td>ğŸ² ìš´ì— ë§¡ê¹€</td>
                    </tr>
                    <tr style="background: #d1fae5;">
                        <td><strong style="color: var(--because-color);">Because</strong></td>
                        <td>ê²½ìŸê°€ &gt; ë‚´ ì›ê°€</td>
                        <td>ê²½ìŸë ¥ ìˆìŒ</td>
                        <td>âœ… ì ê·¹ ì°¸ì—¬</td>
                    </tr>
                </table>
            </div>
        </section>

        <!-- ê³µê³ ë§¤ì¹­ Section (NEW!) -->
        <section id="match" class="section">
            <div class="card">
                <h2>ğŸ¯ íšŒì‚¬-ê³µê³  ë§¤ì¹­</h2>
                <p>ì—…ì¢…ê³¼ ì¡°ê±´ì„ ì„ íƒí•˜ë©´ ë§ì¶¤ ì…ì°°ê³µê³ ë¥¼ ì°¾ì•„ë“œë¦½ë‹ˆë‹¤.</p>

                <!-- ìƒ˜í”Œê¸°ì—… ì„ íƒ -->
                <div class="form-group">
                    <label>ğŸ¢ ìƒ˜í”Œê¸°ì—… ì„ íƒ (ë˜ëŠ” ì§ì ‘ ì„¤ì •)</label>
                    <select id="sampleCompany" class="full-width" onchange="applySampleCompany()">
                        <option value="">-- ì§ì ‘ ì„¤ì • --</option>
                        <option value="road">(ì£¼)í•œê¸¸ë„ë¡œ - í¬ì¥ ì „ë¬¸ | 3ì²œë§Œ~10ì–µ | ì „êµ­</option>
                        <option value="civil">ëŒ€í•œì¢…í•©ê±´ì„¤(ì£¼) - í† ëª© | 5ì–µ~100ì–µ | ì „êµ­</option>
                        <option value="electric">(ì£¼)ë°ì€ì „ê¸° - ì „ê¸° | 3ì²œë§Œ~10ì–µ | ìˆ˜ë„ê¶Œ</option>
                        <option value="building">ë¯¸ë˜ê±´ì¶•(ì£¼) - ê±´ì¶• | 1ì–µ~50ì–µ | ì˜ë‚¨ê¶Œ</option>
                        <option value="landscape">ê·¸ë¦°ì¡°ê²½(ì£¼) - ì¡°ê²½ | 3ì²œë§Œ~5ì–µ | ì¶©ì²­ê¶Œ</option>
                    </select>
                </div>

                <!-- ì—…ì¢… ì„ íƒ (ëŒ€ë¶„ë¥˜ â†’ ì¤‘ë¶„ë¥˜ â†’ ì†Œë¶„ë¥˜) -->
                <div class="form-row">
                    <div class="form-group">
                        <label>ğŸ“‚ ëŒ€ë¶„ë¥˜</label>
                        <select id="matchCategory1" class="full-width" onchange="updateCategory2()">
                            <option value="ê³µì‚¬">ê³µì‚¬</option>
                            <option value="ìš©ì—­">ìš©ì—­</option>
                            <option value="ë¬¼í’ˆ">ë¬¼í’ˆ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ğŸ“ ì¤‘ë¶„ë¥˜</label>
                        <select id="matchCategory2" class="full-width" onchange="updateCategory3()">
                            <option value="ì¢…í•©ê±´ì„¤ì—…">ì¢…í•©ê±´ì„¤ì—…</option>
                            <option value="ì „ë¬¸ê±´ì„¤ì—…">ì „ë¬¸ê±´ì„¤ì—…</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>ğŸ“„ ì†Œë¶„ë¥˜ (ì—…ì¢…)</label>
                        <select id="matchCnstty" class="full-width">
                            <option value="í† ëª©">í† ëª©ê³µì‚¬ì—…</option>
                            <option value="ê±´ì¶•">ê±´ì¶•ê³µì‚¬ì—…</option>
                            <option value="í† ëª©ê±´ì¶•">í† ëª©ê±´ì¶•ê³µì‚¬ì—…</option>
                            <option value="ì‚°ì—…ì„¤ë¹„">ì‚°ì—…ì„¤ë¹„ê³µì‚¬ì—…</option>
                            <option value="ì¡°ê²½">ì¡°ê²½ê³µì‚¬ì—…</option>
                        </select>
                    </div>
                </div>

                <!-- ê¸ˆì•¡ ë²”ìœ„ + ì§€ì—­ -->
                <div class="form-row">
                    <div class="form-group">
                        <label>ğŸ’° ìµœì†Œ ê¸ˆì•¡ (ì²œë§Œì›)</label>
                        <input type="number" id="matchMinPrice" value="3" min="0" max="1000" step="1" class="full-width">
                        <small>ì˜ˆ: 3 = 3ì²œë§Œì›</small>
                    </div>
                    <div class="form-group">
                        <label>ğŸ’° ìµœëŒ€ ê¸ˆì•¡ (ì²œë§Œì›)</label>
                        <input type="number" id="matchMaxPrice" value="100" min="1" max="10000" step="1" class="full-width">
                        <small>ì˜ˆ: 100 = 10ì–µì›</small>
                    </div>
                    <div class="form-group">
                        <label>ğŸ“ ì§€ì—­</label>
                        <select id="matchRegion" class="full-width">
                            <option value="ì „êµ­" selected>ì „êµ­</option>
                            <option value="ìˆ˜ë„ê¶Œ">ìˆ˜ë„ê¶Œ (ì„œìš¸/ê²½ê¸°/ì¸ì²œ)</option>
                            <option value="ì¶©ì²­ê¶Œ">ì¶©ì²­ê¶Œ (ëŒ€ì „/ì„¸ì¢…/ì¶©ë¶/ì¶©ë‚¨)</option>
                            <option value="ì˜ë‚¨ê¶Œ">ì˜ë‚¨ê¶Œ (ë¶€ì‚°/ëŒ€êµ¬/ìš¸ì‚°/ê²½ë¶/ê²½ë‚¨)</option>
                            <option value="í˜¸ë‚¨ê¶Œ">í˜¸ë‚¨ê¶Œ (ê´‘ì£¼/ì „ë¶/ì „ë‚¨)</option>
                            <option value="ê°•ì›ì œì£¼">ê°•ì›/ì œì£¼</option>
                        </select>
                    </div>
                </div>

                <!-- ì¶”ê°€ ì˜µì…˜ -->
                <div class="form-row">
                    <div class="form-group">
                        <label>ğŸ” ì¶”ê°€ í‚¤ì›Œë“œ (ì„ íƒ)</label>
                        <input type="text" id="matchKeyword" placeholder="ì˜ˆ: ì•„ìŠ¤íŒ”íŠ¸, í•™êµ">
                    </div>
                    <div class="form-group">
                        <label>ğŸ“‹ ê³µê³  ìœ í˜•</label>
                        <select id="matchBidType">
                            <option value="ê³µì‚¬">ê³µì‚¬</option>
                            <option value="ìš©ì—­">ìš©ì—­</option>
                            <option value="ë¬¼í’ˆ">ë¬¼í’ˆ</option>
                        </select>
                    </div>
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="searchMatchingBids()">ğŸ¯ ë§ì¶¤ ê³µê³  ì°¾ê¸°</button>
                    <button class="btn btn-secondary" onclick="resetMatch()">ì´ˆê¸°í™”</button>
                </div>
            </div>

            <!-- ë§¤ì¹­ ê²°ê³¼ -->
            <div id="matchResult" class="card" style="display: none;">
                <h2>ğŸ“‹ ë§¤ì¹­ ê²°ê³¼</h2>
                <div id="matchSummary" class="match-summary"></div>
                <div id="matchList" class="match-list"></div>
            </div>

            <!-- N2B ë¶„ì„ -->
            <div id="matchN2B" class="card" style="display: none;">
                <div class="n2b-result"></div>
            </div>

            <!-- ë¡œë”© -->
            <div id="matchLoading" class="loading">
                <div class="spinner"></div>
                <p>ë§ì¶¤ ê³µê³ ë¥¼ ì°¾ê³  ìˆìŠµë‹ˆë‹¤...</p>
            </div>
        </section>

        <!-- Cost Analysis Section -->
        <section id="cost" class="section">
            <div class="card">
                <h2>ğŸ“Š ê²½ìŸê°€ ë¶„ì„</h2>
                <p>ê²½ìŸê°€(ë‚™ì°°ë¥ )ì™€ ë‚´ ì›ê°€ë¥¼ ë¹„êµí•˜ì—¬ ì´ìœ¤ì„ ê³„ì‚°í•©ë‹ˆë‹¤.</p>

                <div class="form-group">
                    <label>ê³µì¢… ì„ íƒ</label>
                    <div class="work-type-grid">
                        <button class="work-type-btn selected" onclick="selectWorkType(this, 'ë„ë¡œ')">
                            <span class="emoji">ğŸ›£ï¸</span>ë„ë¡œ
                        </button>
                        <button class="work-type-btn" onclick="selectWorkType(this, 'í† ëª©')">
                            <span class="emoji">ğŸ—ï¸</span>í† ëª©
                        </button>
                        <button class="work-type-btn" onclick="selectWorkType(this, 'ê±´ì¶•')">
                            <span class="emoji">ğŸ¢</span>ê±´ì¶•
                        </button>
                        <button class="work-type-btn" onclick="selectWorkType(this, 'ì„¤ë¹„')">
                            <span class="emoji">âš™ï¸</span>ì„¤ë¹„
                        </button>
                        <button class="work-type-btn" onclick="selectWorkType(this, 'ì „ê¸°')">
                            <span class="emoji">âš¡</span>ì „ê¸°
                        </button>
                        <button class="work-type-btn" onclick="selectWorkType(this, 'ì¡°ê²½')">
                            <span class="emoji">ğŸŒ³</span>ì¡°ê²½
                        </button>
                        <button class="work-type-btn" onclick="selectWorkType(this, 'ìƒí•˜ìˆ˜ë„')">
                            <span class="emoji">ğŸ’§</span>ìƒí•˜ìˆ˜ë„
                        </button>
                        <button class="work-type-btn" onclick="selectWorkType(this, 'ê¸°íƒ€')">
                            <span class="emoji">ğŸ“¦</span>ê¸°íƒ€
                        </button>
                    </div>
                </div>

                <div class="form-group">
                    <label>ê¸°ì´ˆê¸ˆì•¡ (ì›)</label>
                    <input type="text" id="basePrice" placeholder="ì˜ˆ: 100000000" oninput="formatNumber(this)">
                    <small style="color: var(--text-muted);">ê³µê³ ì— í‘œì‹œëœ ê¸°ì´ˆê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”</small>
                </div>

                <div class="form-group">
                    <label>ê²½ìŸê°€ = ë‚™ì°°ë¥  (%)</label>
                    <input type="number" id="bidRate" value="85" min="70" max="100" step="0.1">
                    <small style="color: var(--text-muted);">ê³µì¢…ë³„ í‰ê·  ë‚™ì°°ë¥  (ì‹œì¥ ê²½ìŸê°€)</small>
                </div>

                <div class="info-box">
                    <h4>ğŸ”§ ìš°ë¦¬ íšŒì‚¬ ì ˆê°ë¥  (ë‚´ ì›ê°€ ì‚°ì¶œ)</h4>
                    <p>ê±°ë˜ì²˜ ì§ê±°ë˜, ì§ì˜ì¸ë ¥, ìê°€ì¥ë¹„ ë“± ìš°ë¦¬ íšŒì‚¬ ê°•ì ì— ë”°ë¥¸ ì›ê°€ ì ˆê°ë¥ ì„ ì…ë ¥í•˜ì„¸ìš”.</p>
                </div>

                <div class="slider-group">
                    <label>
                        <span>ì¬ë£Œë¹„ ì ˆê°ë¥  (ë‹¨ê³¨ ê±°ë˜ì²˜, ì§ê±°ë˜ ë“±)</span>
                        <span class="slider-value" id="materialValue">10%</span>
                    </label>
                    <input type="range" id="materialDiscount" min="0" max="30" value="10" 
                           oninput="updateSliderValue('material')">
                </div>

                <div class="slider-group">
                    <label>
                        <span>ë…¸ë¬´ë¹„ ì ˆê°ë¥  (ì§ì˜ ì¸ë ¥, ìˆ™ë ¨ê³µ ë“±)</span>
                        <span class="slider-value" id="laborValue">15%</span>
                    </label>
                    <input type="range" id="laborDiscount" min="0" max="30" value="15"
                           oninput="updateSliderValue('labor')">
                </div>

                <div class="slider-group">
                    <label>
                        <span>ê²½ë¹„ ì ˆê°ë¥  (ìê°€ ì¥ë¹„, í˜„ì¥ ì¸ì ‘ ë“±)</span>
                        <span class="slider-value" id="equipmentValue">10%</span>
                    </label>
                    <input type="range" id="equipmentDiscount" min="0" max="30" value="10"
                           oninput="updateSliderValue('equipment')">
                </div>

                <div class="btn-group">
                    <button class="btn btn-primary" onclick="calculateCost()">ğŸ“Š ê²½ìŸê°€ ë¶„ì„</button>
                    <button class="btn btn-secondary" onclick="resetCost()">ì´ˆê¸°í™”</button>
                </div>

                <div class="loading" id="costLoading">
                    <div class="spinner"></div>
                    <p>ê²½ìŸê°€ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
                </div>

                <div id="costResult" class="result-box">
                    <!-- ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë¨ -->
                </div>
            </div>
        </section>

    </main>

    <script>
        // API ì—”ë“œí¬ì¸íŠ¸
        const API_BASE = 'https://wise-bid-backend.onrender.com';
        
        // ìƒíƒœ
        let selectedWorkType = 'ë„ë¡œ';
        let selectedProfile = 'road';

        // ìƒ˜í”Œê¸°ì—… ë°ì´í„° (ê¸ˆì•¡: ì²œë§Œì› ë‹¨ìœ„)
        const SAMPLE_COMPANIES = {
            road: { cnstty: 'í¬ì¥', minPrice: '3', maxPrice: '100', region: 'ì „êµ­', cat1: 'ê³µì‚¬', cat2: 'ì „ë¬¸ê±´ì„¤ì—…' },
            civil: { cnstty: 'í† ëª©', minPrice: '50', maxPrice: '1000', region: 'ì „êµ­', cat1: 'ê³µì‚¬', cat2: 'ì¢…í•©ê±´ì„¤ì—…' },
            electric: { cnstty: 'ì „ê¸°', minPrice: '3', maxPrice: '100', region: 'ìˆ˜ë„ê¶Œ', cat1: 'ê³µì‚¬', cat2: 'ì „ë¬¸ê±´ì„¤ì—…' },
            building: { cnstty: 'ê±´ì¶•', minPrice: '10', maxPrice: '500', region: 'ì˜ë‚¨ê¶Œ', cat1: 'ê³µì‚¬', cat2: 'ì¢…í•©ê±´ì„¤ì—…' },
            landscape: { cnstty: 'ì¡°ê²½', minPrice: '3', maxPrice: '50', region: 'ì¶©ì²­ê¶Œ', cat1: 'ê³µì‚¬', cat2: 'ì¢…í•©ê±´ì„¤ì—…' }
        };

        // ë¶„ë¥˜ ë°ì´í„°
        const CATEGORIES = {
            'ê³µì‚¬': {
                'ì¢…í•©ê±´ì„¤ì—…': ['í† ëª©', 'ê±´ì¶•', 'í† ëª©ê±´ì¶•', 'ì‚°ì—…ì„¤ë¹„', 'ì¡°ê²½'],
                'ì „ë¬¸ê±´ì„¤ì—…': ['í¬ì¥', 'ì „ê¸°', 'í†µì‹ ', 'ì†Œë°©', 'ì‹¤ë‚´ê±´ì¶•', 'ì² ê·¼ì½˜í¬ë¦¬íŠ¸', 'ìƒí•˜ìˆ˜ë„', 'ê¸ˆì†ì°½í˜¸']
            },
            'ìš©ì—­': {
                'ê¸°ìˆ ìš©ì—­': ['ì„¤ê³„', 'ê°ë¦¬', 'ì¸¡ëŸ‰', 'ì—”ì§€ë‹ˆì–´ë§'],
                'ì¼ë°˜ìš©ì—­': ['ì²­ì†Œ', 'ê²½ë¹„', 'ì‹œì„¤ê´€ë¦¬', 'SWê°œë°œ', 'ì—°êµ¬']
            },
            'ë¬¼í’ˆ': {
                'ì¼ë°˜ë¬¼í’ˆ': ['ì‚¬ë¬´ìš©í’ˆ', 'ì „ì‚°ì¥ë¹„', 'ì°¨ëŸ‰'],
                'ì‹œì„¤ìì¬': ['ê±´ì¶•ìì¬', 'ì „ê¸°ìì¬', 'ë°°ê´€ìì¬']
            }
        };

        // ìƒ˜í”Œê¸°ì—… ì ìš©
        function applySampleCompany() {
            const company = document.getElementById('sampleCompany').value;
            if (!company || !SAMPLE_COMPANIES[company]) return;
            
            const data = SAMPLE_COMPANIES[company];
            document.getElementById('matchCategory1').value = data.cat1;
            updateCategory2();
            document.getElementById('matchCategory2').value = data.cat2;
            updateCategory3();
            
            // ì†Œë¶„ë¥˜ ì„¤ì • (ì•½ê°„ì˜ ë”œë ˆì´ í›„)
            setTimeout(() => {
                document.getElementById('matchCnstty').value = data.cnstty;
            }, 100);
            
            document.getElementById('matchMinPrice').value = data.minPrice;
            document.getElementById('matchMaxPrice').value = data.maxPrice;
            document.getElementById('matchRegion').value = data.region;
        }

        // ëŒ€ë¶„ë¥˜ ë³€ê²½ ì‹œ ì¤‘ë¶„ë¥˜ ì—…ë°ì´íŠ¸
        function updateCategory2() {
            const cat1 = document.getElementById('matchCategory1').value;
            const cat2Select = document.getElementById('matchCategory2');
            const subCats = CATEGORIES[cat1] || {};
            
            cat2Select.innerHTML = '';
            Object.keys(subCats).forEach(name => {
                const opt = document.createElement('option');
                opt.value = name;
                opt.textContent = name;
                cat2Select.appendChild(opt);
            });
            
            updateCategory3();
        }

        // ì¤‘ë¶„ë¥˜ ë³€ê²½ ì‹œ ì†Œë¶„ë¥˜ ì—…ë°ì´íŠ¸
        function updateCategory3() {
            const cat1 = document.getElementById('matchCategory1').value;
            const cat2 = document.getElementById('matchCategory2').value;
            const cat3Select = document.getElementById('matchCnstty');
            const items = CATEGORIES[cat1]?.[cat2] || [];
            
            const labels = {
                'í† ëª©': 'í† ëª©ê³µì‚¬ì—…', 'ê±´ì¶•': 'ê±´ì¶•ê³µì‚¬ì—…', 'í† ëª©ê±´ì¶•': 'í† ëª©ê±´ì¶•ê³µì‚¬ì—…',
                'ì‚°ì—…ì„¤ë¹„': 'ì‚°ì—…ì„¤ë¹„ê³µì‚¬ì—…', 'ì¡°ê²½': 'ì¡°ê²½ê³µì‚¬ì—…', 'í¬ì¥': 'ì§€ë°˜ì¡°ì„±í¬ì¥ê³µì‚¬ì—…',
                'ì „ê¸°': 'ì „ê¸°ê³µì‚¬ì—…', 'í†µì‹ ': 'ì •ë³´í†µì‹ ê³µì‚¬ì—…', 'ì†Œë°©': 'ì†Œë°©ì‹œì„¤ê³µì‚¬ì—…',
                'ì‹¤ë‚´ê±´ì¶•': 'ì‹¤ë‚´ê±´ì¶•ê³µì‚¬ì—…', 'ì² ê·¼ì½˜í¬ë¦¬íŠ¸': 'ì² ê·¼ì½˜í¬ë¦¬íŠ¸ê³µì‚¬ì—…',
                'ìƒí•˜ìˆ˜ë„': 'ìƒí•˜ìˆ˜ë„ì„¤ë¹„ê³µì‚¬ì—…', 'ê¸ˆì†ì°½í˜¸': 'ê¸ˆì†ì°½í˜¸ì§€ë¶•ê³µì‚¬ì—…',
                'ì„¤ê³„': 'ì„¤ê³„ìš©ì—­', 'ê°ë¦¬': 'ê°ë¦¬ìš©ì—­', 'ì¸¡ëŸ‰': 'ì¸¡ëŸ‰ìš©ì—­', 'ì—”ì§€ë‹ˆì–´ë§': 'ì—”ì§€ë‹ˆì–´ë§',
                'ì²­ì†Œ': 'ì²­ì†Œìš©ì—­', 'ê²½ë¹„': 'ê²½ë¹„ìš©ì—­', 'ì‹œì„¤ê´€ë¦¬': 'ì‹œì„¤ê´€ë¦¬ìš©ì—­',
                'SWê°œë°œ': 'SWê°œë°œìš©ì—­', 'ì—°êµ¬': 'í•™ìˆ ì—°êµ¬ìš©ì—­',
                'ì‚¬ë¬´ìš©í’ˆ': 'ì‚¬ë¬´ìš©í’ˆ', 'ì „ì‚°ì¥ë¹„': 'ì „ì‚°ì¥ë¹„', 'ì°¨ëŸ‰': 'ì°¨ëŸ‰',
                'ê±´ì¶•ìì¬': 'ê±´ì¶•ìì¬', 'ì „ê¸°ìì¬': 'ì „ê¸°ìì¬', 'ë°°ê´€ìì¬': 'ë°°ê´€ìì¬'
            };
            
            cat3Select.innerHTML = '';
            items.forEach(item => {
                const opt = document.createElement('option');
                opt.value = item;
                opt.textContent = labels[item] || item;
                cat3Select.appendChild(opt);
            });
        }

        // ì„¹ì…˜ ì „í™˜
        function showSection(sectionId, btn) {
            document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
            document.getElementById(sectionId).classList.add('active');
            
            document.querySelectorAll('nav button').forEach(b => b.classList.remove('active'));
            if (btn) {
                btn.classList.add('active');
            } else {
                document.querySelectorAll('nav button').forEach(b => {
                    if (b.textContent.includes(sectionId === 'home' ? 'í™ˆ' : 
                        sectionId === 'match' ? 'ë§¤ì¹­' :
                        sectionId === 'cost' ? 'ì›ê°€' : 
                        sectionId === 'decision' ? 'íŒì •' : 'ë‹¨ê°€')) {
                        b.classList.add('active');
                    }
                });
            }
        }

        // í”„ë¡œí•„ ì„ íƒ
        function selectProfile(btn, profile) {
            document.querySelectorAll('.profile-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            selectedProfile = profile;
        }

        // ê³µê³  ë§¤ì¹­ ê²€ìƒ‰
        async function searchMatchingBids() {
            const keyword = document.getElementById('matchKeyword').value;
            const bidType = document.getElementById('matchBidType').value;
            const cnstty = document.getElementById('matchCnstty').value;
            
            // ì²œë§Œì› ë‹¨ìœ„ â†’ ì› ë‹¨ìœ„ ë³€í™˜
            const minPrice = (parseInt(document.getElementById('matchMinPrice').value) || 0) * 10000000;
            const maxPrice = (parseInt(document.getElementById('matchMaxPrice').value) || 10000) * 10000000;
            
            // ì„ íƒëœ ê¶Œì—­ ê°€ì ¸ì˜¤ê¸°
            const region = document.getElementById('matchRegion').value;
            const regions = [region];

            document.getElementById('matchLoading').classList.add('show');
            document.getElementById('matchResult').style.display = 'none';
            document.getElementById('matchN2B').style.display = 'none';

            try {
                const response = await fetch(`${API_BASE}/api/custom-match`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        work_types: [cnstty],
                        min_price: minPrice,
                        max_price: maxPrice,
                        regions: regions,
                        keyword: keyword,
                        bid_type: bidType
                    })
                });
                const data = await response.json();

                if (data.success) {
                    displayMatchResult(data);
                } else {
                    alert('ë§¤ì¹­ ì‹¤íŒ¨: ' + (data.detail || 'ì˜¤ë¥˜ ë°œìƒ'));
                }
            } catch (error) {
                console.error('Error:', error);
                alert('ì„œë²„ ì—°ê²° ì˜¤ë¥˜');
            } finally {
                document.getElementById('matchLoading').classList.remove('show');
            }
        }

        // ë§¤ì¹­ ê²°ê³¼ í‘œì‹œ
        function displayMatchResult(data) {
            // ìš”ì•½
            document.getElementById('matchSummary').innerHTML = `
                <div class="match-stat">
                    <div class="value">${data.total_found}</div>
                    <div class="label">ì „ì²´ ê³µê³ </div>
                </div>
                <div class="match-stat">
                    <div class="value">${data.matched_count}</div>
                    <div class="label">ë§¤ì¹­ ê³µê³ </div>
                </div>
                <div class="match-stat">
                    <div class="value">${Math.round(data.matched_count / Math.max(data.total_found, 1) * 100)}%</div>
                    <div class="label">ë§¤ì¹­ë¥ </div>
                </div>
            `;

            // ê³µê³  ëª©ë¡
            const listHtml = data.matched.map(bid => {
                const score = bid.match_score || 0;
                const scoreClass = score >= 50 ? 'high' : score >= 30 ? 'medium' : 'low';
                const price = bid.base_price || bid.estimated_price || 0;
                const priceFormatted = price ? parseInt(price).toLocaleString() + 'ì›' : 'ë¯¸ì •';
                
                const reasons = (bid.match_reasons || []).map(r => 
                    `<span class="match-reason">${r}</span>`
                ).join('');

                return `
                    <div class="match-item">
                        <div class="match-item-header">
                            <div class="match-item-title">${bid.bid_name || 'ê³µê³ ëª… ì—†ìŒ'}</div>
                            <span class="match-score ${scoreClass}">${score}ì </span>
                        </div>
                        <div class="match-item-info">
                            <div>ğŸ¢ ${bid.agency || '-'}</div>
                            <div>ğŸ’° ${priceFormatted}</div>
                            <div>ğŸ“… ë§ˆê°: ${bid.deadline ? bid.deadline.substring(0, 10) : '-'}</div>
                            <div>ğŸ“‹ ${bid.bid_method || '-'}</div>
                        </div>
                        <div class="match-reasons">${reasons}</div>
                        <div class="match-item-actions">
                            <button class="btn btn-secondary" onclick="copyToCost(${price}, document.getElementById('matchCnstty').value)">ğŸ“Š ê²½ìŸê°€ë¶„ì„</button>
                            ${bid.url ? `<button class="btn btn-primary" onclick="window.open('${bid.url}', '_blank')">ğŸ”— ìƒì„¸ë³´ê¸°</button>` : ''}
                        </div>
                    </div>
                `;
            }).join('');

            document.getElementById('matchList').innerHTML = listHtml || '<p style="text-align:center; color: var(--text-muted);">ë§¤ì¹­ëœ ê³µê³ ê°€ ì—†ìŠµë‹ˆë‹¤.</p>';
            document.getElementById('matchResult').style.display = 'block';

            // N2B ë¶„ì„
            if (data.n2b) {
                document.getElementById('matchN2B').innerHTML = `
                    <div class="n2b-result">
                        <div class="n2b-item n2b-not">
                            <strong>Not:</strong> ${data.n2b.not}
                        </div>
                        <div class="n2b-item n2b-but">
                            <strong>But:</strong> ${data.n2b.but}
                        </div>
                        <div class="n2b-item n2b-because">
                            <strong>Because:</strong> ${data.n2b.because}
                        </div>
                    </div>
                `;
                document.getElementById('matchN2B').style.display = 'block';
            }
        }

        // ì›ê°€ë¶„ì„ìœ¼ë¡œ ë³µì‚¬
        function copyToCost(price, workType) {
            if (price > 0) {
                document.getElementById('basePrice').value = parseInt(price).toLocaleString();
                
                // ê³µì¢… ë§¤í•‘
                const workTypeMap = {
                    'í¬ì¥': 'ë„ë¡œ', 'í† ëª©': 'í† ëª©', 'ê±´ì¶•': 'ê±´ì¶•', 
                    'ì „ê¸°': 'ì „ê¸°', 'í†µì‹ ': 'ì „ê¸°', 'ì†Œë°©': 'ì„¤ë¹„',
                    'ì¡°ê²½': 'ì¡°ê²½', 'ìƒí•˜ìˆ˜ë„': 'ìƒí•˜ìˆ˜ë„', 'ì² ê·¼': 'ê±´ì¶•',
                    'ì•„ìŠ¤ì½˜': 'ë„ë¡œ', 'ê¸ˆì†ì°½í˜¸': 'ê±´ì¶•'
                };
                const mappedType = workTypeMap[workType] || workType || 'ë„ë¡œ';
                selectedWorkType = mappedType;
                
                // ê³µì¢… ë²„íŠ¼ ì„ íƒ ìƒíƒœ ë³€ê²½
                document.querySelectorAll('.work-type-btn').forEach(btn => {
                    btn.classList.remove('selected');
                    const btnType = btn.getAttribute('onclick')?.match(/'([^']+)'/)?.[1];
                    if (btnType === mappedType) {
                        btn.classList.add('selected');
                    }
                });
                
                showSection('cost');
            }
        }

        // ë§¤ì¹­ ì´ˆê¸°í™”
        function resetMatch() {
            document.getElementById('matchKeyword').value = '';
            document.getElementById('matchBidType').value = 'ê³µì‚¬';
            document.getElementById('matchResult').style.display = 'none';
            document.getElementById('matchN2B').style.display = 'none';
        }

        // ê³µì¢… ì„ íƒ
        function selectWorkType(btn, type) {
            document.querySelectorAll('.work-type-btn').forEach(b => b.classList.remove('selected'));
            btn.classList.add('selected');
            selectedWorkType = type;
        }

        // ìŠ¬ë¼ì´ë” ê°’ ì—…ë°ì´íŠ¸
        function updateSliderValue(type) {
            const slider = document.getElementById(type + 'Discount');
            const valueSpan = document.getElementById(type + 'Value');
            valueSpan.textContent = slider.value + '%';
        }

        // ìˆ«ì í¬ë§·íŒ…
        function formatNumber(input) {
            let value = input.value.replace(/[^\d]/g, '');
            if (value) {
                input.value = parseInt(value).toLocaleString();
            }
        }

        // ìˆ«ì íŒŒì‹±
        function parseNumber(str) {
            return parseInt(str.replace(/[^\d]/g, '')) || 0;
        }

        // ì›ê°€ ê³„ì‚°
        async function calculateCost() {
            const basePrice = parseNumber(document.getElementById('basePrice').value);
            if (!basePrice) {
                alert('ê¸°ì´ˆê¸ˆì•¡ì„ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }

            const bidRate = parseFloat(document.getElementById('bidRate').value) || 85;
            const materialDiscount = parseInt(document.getElementById('materialDiscount').value);
            const laborDiscount = parseInt(document.getElementById('laborDiscount').value);
            const equipmentDiscount = parseInt(document.getElementById('equipmentDiscount').value);

            // ë¡œë”© í‘œì‹œ
            document.getElementById('costLoading').classList.add('show');
            document.getElementById('costResult').classList.remove('show');

            try {
                // ê²½ìŸê°€ ê¸°ë°˜ ê³„ì‚°
                const result = calculateCostOffline(basePrice, selectedWorkType, materialDiscount, laborDiscount, equipmentDiscount, bidRate);
                displayCostResult(result);
            } catch (error) {
                console.error('Error:', error);
                const result = calculateCostOffline(basePrice, selectedWorkType, materialDiscount, laborDiscount, equipmentDiscount, bidRate);
                displayCostResult(result);
            } finally {
                document.getElementById('costLoading').classList.remove('show');
            }
        }

        // ê²½ìŸê°€ ê¸°ë°˜ ì›ê°€ ê³„ì‚°
        function calculateCostOffline(basePrice, workType, matDisc, labDisc, eqDisc, bidRate = 85) {
            const ratios = {
                'ë„ë¡œ': { 'ì¬ë£Œë¹„': 55, 'ë…¸ë¬´ë¹„': 25, 'ê²½ë¹„': 20 },
                'í† ëª©': { 'ì¬ë£Œë¹„': 40, 'ë…¸ë¬´ë¹„': 35, 'ê²½ë¹„': 25 },
                'ê±´ì¶•': { 'ì¬ë£Œë¹„': 50, 'ë…¸ë¬´ë¹„': 30, 'ê²½ë¹„': 20 },
                'ì„¤ë¹„': { 'ì¬ë£Œë¹„': 60, 'ë…¸ë¬´ë¹„': 25, 'ê²½ë¹„': 15 },
                'ì „ê¸°': { 'ì¬ë£Œë¹„': 55, 'ë…¸ë¬´ë¹„': 30, 'ê²½ë¹„': 15 },
                'ì¡°ê²½': { 'ì¬ë£Œë¹„': 45, 'ë…¸ë¬´ë¹„': 35, 'ê²½ë¹„': 20 },
                'ìƒí•˜ìˆ˜ë„': { 'ì¬ë£Œë¹„': 55, 'ë…¸ë¬´ë¹„': 25, 'ê²½ë¹„': 20 },
                'ê¸°íƒ€': { 'ì¬ë£Œë¹„': 50, 'ë…¸ë¬´ë¹„': 30, 'ê²½ë¹„': 20 }
            };

            const ratio = ratios[workType] || ratios['ê¸°íƒ€'];
            
            // ê²½ìŸê°€ ê³„ì‚°
            const competitivePrice = Math.floor(basePrice * bidRate / 100);
            const bubble = basePrice - competitivePrice;
            const bubbleRate = ((bubble / basePrice) * 100).toFixed(1);
            
            // ì§ì ‘ê³µì‚¬ë¹„ (ê¸°ì´ˆê¸ˆì•¡ì˜ 74%)
            const directCost = Math.floor(basePrice * 0.74);
            
            // í‘œì¤€ì›ê°€ (ì¬ë£Œ/ë…¸ë¬´/ê²½ë¹„)
            const stdMaterial = Math.floor(directCost * ratio['ì¬ë£Œë¹„'] / 100);
            const stdLabor = Math.floor(directCost * ratio['ë…¸ë¬´ë¹„'] / 100);
            const stdEquipment = Math.floor(directCost * ratio['ê²½ë¹„'] / 100);
            
            // ë‚´ ì›ê°€ (ì ˆê°ë¥  ì ìš©)
            const myMaterial = Math.floor(stdMaterial * (1 - matDisc / 100));
            const myLabor = Math.floor(stdLabor * (1 - labDisc / 100));
            const myEquipment = Math.floor(stdEquipment * (1 - eqDisc / 100));
            
            const myDirect = myMaterial + myLabor + myEquipment;
            const indirectRatio = myDirect / directCost;
            const myIndirect = Math.floor(basePrice * 0.26 * indirectRatio);
            const myCost = myDirect + myIndirect;
            
            // ì´ìœ¤ = ê²½ìŸê°€ - ë‚´ ì›ê°€
            const profit = competitivePrice - myCost;
            const profitRate = ((profit / basePrice) * 100).toFixed(1);
            
            // N2B íŒì •
            let n2bResult = 'But';
            let n2bDesc = 'ê²½ìŸ ìˆ˜ì¤€, ìš´ì— ë§¡ê¹€ ğŸ²';
            if (profit > basePrice * 0.05) {
                n2bResult = 'Because';
                n2bDesc = 'ê²½ìŸë ¥ ìˆìŒ, ì ê·¹ ì°¸ì—¬ âœ…';
            } else if (profit < 0) {
                n2bResult = 'Not';
                n2bDesc = 'ê²½ìŸë ¥ ì—†ìŒ, ì°¸ì—¬ ë¶ˆê°€ âŒ';
            }

            return {
                'ê¸°ì´ˆê¸ˆì•¡': basePrice,
                'ê³µì¢…': workType,
                'ë‚™ì°°ë¥ ': bidRate,
                'ê²½ìŸê°€': competitivePrice,
                'ê±°í’ˆ': bubble,
                'ê±°í’ˆë¥ ': parseFloat(bubbleRate),
                'í‘œì¤€ì›ê°€': {
                    'ì¬ë£Œë¹„': stdMaterial,
                    'ë…¸ë¬´ë¹„': stdLabor,
                    'ê²½ë¹„': stdEquipment,
                    'ì§ì ‘ê³µì‚¬ë¹„': directCost,
                    'ê°„ì ‘ë¹„': Math.floor(basePrice * 0.26),
                    'í•©ê³„': basePrice
                },
                'ë‚´ì›ê°€': {
                    'ì¬ë£Œë¹„': myMaterial,
                    'ë…¸ë¬´ë¹„': myLabor,
                    'ê²½ë¹„': myEquipment,
                    'ì§ì ‘ê³µì‚¬ë¹„': myDirect,
                    'ê°„ì ‘ë¹„': myIndirect,
                    'í•©ê³„': myCost
                },
                'ì´ìœ¤': profit,
                'ì´ìœ¤ë¥ ': parseFloat(profitRate),
                'N2B': n2bResult,
                'N2Bì„¤ëª…': n2bDesc
            };
        }

        // ê²½ìŸê°€ ë¶„ì„ ê²°ê³¼ í‘œì‹œ
        function displayCostResult(data) {
            const resultDiv = document.getElementById('costResult');
            
            // N2B íŒì •ì— ë”°ë¥¸ ìƒ‰ìƒ
            const n2bClass = data['N2B'] === 'Because' ? 'positive' : 
                            data['N2B'] === 'But' ? 'neutral' : 'negative';
            
            const n2bColor = data['N2B'] === 'Because' ? 'var(--because-color)' : 
                            data['N2B'] === 'But' ? 'var(--but-color)' : 'var(--not-color)';
            
            // ê³µì¢…ë³„ ë¹„ìœ¨
            const ratios = {
                'ë„ë¡œ': { 'ì¬ë£Œë¹„': 55, 'ë…¸ë¬´ë¹„': 25, 'ê²½ë¹„': 20 },
                'í† ëª©': { 'ì¬ë£Œë¹„': 40, 'ë…¸ë¬´ë¹„': 35, 'ê²½ë¹„': 25 },
                'ê±´ì¶•': { 'ì¬ë£Œë¹„': 50, 'ë…¸ë¬´ë¹„': 30, 'ê²½ë¹„': 20 },
                'ì„¤ë¹„': { 'ì¬ë£Œë¹„': 60, 'ë…¸ë¬´ë¹„': 25, 'ê²½ë¹„': 15 },
                'ì „ê¸°': { 'ì¬ë£Œë¹„': 55, 'ë…¸ë¬´ë¹„': 30, 'ê²½ë¹„': 15 },
                'ì¡°ê²½': { 'ì¬ë£Œë¹„': 45, 'ë…¸ë¬´ë¹„': 35, 'ê²½ë¹„': 20 },
                'ìƒí•˜ìˆ˜ë„': { 'ì¬ë£Œë¹„': 55, 'ë…¸ë¬´ë¹„': 25, 'ê²½ë¹„': 20 },
                'ê¸°íƒ€': { 'ì¬ë£Œë¹„': 50, 'ë…¸ë¬´ë¹„': 30, 'ê²½ë¹„': 20 }
            };
            const ratio = ratios[data['ê³µì¢…']] || ratios['ê¸°íƒ€'];
            
            resultDiv.innerHTML = `
                <h3>ğŸ“Š ê²½ìŸê°€ ë¶„ì„ ê²°ê³¼</h3>
                
                <!-- N2B íŒì • -->
                <div class="decision-result ${n2bClass}">
                    <div class="decision-score" style="color: ${n2bColor}">${data['N2B']}</div>
                    <div class="decision-label">${data['N2Bì„¤ëª…']}</div>
                </div>

                <!-- í•µì‹¬ ì§€í‘œ -->
                <div class="match-summary" style="margin-top: 1.5rem;">
                    <div class="match-stat">
                        <div class="value">${data['ê±°í’ˆë¥ ']}%</div>
                        <div class="label">ê±°í’ˆë¥ </div>
                    </div>
                    <div class="match-stat">
                        <div class="value" style="color: ${n2bColor}">${data['ì´ìœ¤ë¥ ']}%</div>
                        <div class="label">ì´ìœ¤ë¥ </div>
                    </div>
                    <div class="match-stat">
                        <div class="value" style="color: ${n2bColor}">${data['ì´ìœ¤'].toLocaleString()}</div>
                        <div class="label">ì´ìœ¤ (ì›)</div>
                    </div>
                </div>

                <!-- ê°€ê²© êµ¬ì¡° -->
                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">ğŸ’° ê°€ê²© êµ¬ì¡°</h4>
                <table class="cost-table">
                    <tr>
                        <th>êµ¬ë¶„</th>
                        <th>ê¸ˆì•¡</th>
                        <th>ë¹„ìœ¨</th>
                        <th>ì„¤ëª…</th>
                    </tr>
                    <tr>
                        <td>ê¸°ì´ˆê¸ˆì•¡</td>
                        <td>${data['ê¸°ì´ˆê¸ˆì•¡'].toLocaleString()}ì›</td>
                        <td>100%</td>
                        <td>ë°œì£¼ì²˜ ì‚°ì •</td>
                    </tr>
                    <tr style="background: #fef3c7;">
                        <td><strong>ê²½ìŸê°€</strong></td>
                        <td><strong>${data['ê²½ìŸê°€'].toLocaleString()}ì›</strong></td>
                        <td><strong>${data['ë‚™ì°°ë¥ ']}%</strong></td>
                        <td>ì‹œì¥ ê²½ìŸ ìˆ˜ì¤€</td>
                    </tr>
                    <tr>
                        <td>ë‚´ ì›ê°€</td>
                        <td>${data['ë‚´ì›ê°€']['í•©ê³„'].toLocaleString()}ì›</td>
                        <td>${((data['ë‚´ì›ê°€']['í•©ê³„'] / data['ê¸°ì´ˆê¸ˆì•¡']) * 100).toFixed(1)}%</td>
                        <td>ë‚´ ì‹¤í–‰ ë¹„ìš©</td>
                    </tr>
                    <tr class="total" style="background: ${data['ì´ìœ¤'] >= 0 ? '#d1fae5' : '#fee2e2'};">
                        <td><strong>ì´ìœ¤</strong></td>
                        <td><strong style="color: ${n2bColor}">${data['ì´ìœ¤'].toLocaleString()}ì›</strong></td>
                        <td><strong style="color: ${n2bColor}">${data['ì´ìœ¤ë¥ ']}%</strong></td>
                        <td>${data['ì´ìœ¤'] >= 0 ? 'ê²½ìŸê°€ - ë‚´ì›ê°€' : 'âš ï¸ ì†í•´!'}</td>
                    </tr>
                </table>

                <!-- ìƒì„¸ ì›ê°€ -->
                <h4 style="margin-top: 1.5rem; margin-bottom: 0.5rem;">ğŸ“‹ ìƒì„¸ ì›ê°€ (ì§ì ‘ê³µì‚¬ë¹„ ê¸°ì¤€)</h4>
                <table class="cost-table">
                    <tr>
                        <th>êµ¬ë¶„</th>
                        <th>í‘œì¤€ì›ê°€</th>
                        <th>ë‚´ ì›ê°€</th>
                        <th>ì ˆê°ì•¡</th>
                    </tr>
                    <tr>
                        <td>ì¬ë£Œë¹„ (${ratio['ì¬ë£Œë¹„']}%)</td>
                        <td>${data['í‘œì¤€ì›ê°€']['ì¬ë£Œë¹„'].toLocaleString()}ì›</td>
                        <td>${data['ë‚´ì›ê°€']['ì¬ë£Œë¹„'].toLocaleString()}ì›</td>
                        <td class="saving">-${(data['í‘œì¤€ì›ê°€']['ì¬ë£Œë¹„'] - data['ë‚´ì›ê°€']['ì¬ë£Œë¹„']).toLocaleString()}ì›</td>
                    </tr>
                    <tr>
                        <td>ë…¸ë¬´ë¹„ (${ratio['ë…¸ë¬´ë¹„']}%)</td>
                        <td>${data['í‘œì¤€ì›ê°€']['ë…¸ë¬´ë¹„'].toLocaleString()}ì›</td>
                        <td>${data['ë‚´ì›ê°€']['ë…¸ë¬´ë¹„'].toLocaleString()}ì›</td>
                        <td class="saving">-${(data['í‘œì¤€ì›ê°€']['ë…¸ë¬´ë¹„'] - data['ë‚´ì›ê°€']['ë…¸ë¬´ë¹„']).toLocaleString()}ì›</td>
                    </tr>
                    <tr>
                        <td>ê²½ë¹„ (${ratio['ê²½ë¹„']}%)</td>
                        <td>${data['í‘œì¤€ì›ê°€']['ê²½ë¹„'].toLocaleString()}ì›</td>
                        <td>${data['ë‚´ì›ê°€']['ê²½ë¹„'].toLocaleString()}ì›</td>
                        <td class="saving">-${(data['í‘œì¤€ì›ê°€']['ê²½ë¹„'] - data['ë‚´ì›ê°€']['ê²½ë¹„']).toLocaleString()}ì›</td>
                    </tr>
                </table>

                <!-- N2B ë¶„ì„ -->
                <div class="n2b-result" style="margin-top: 1.5rem;">
                    <h4>ğŸ“‹ N2B ë¶„ì„</h4>
                    <div class="n2b-item">
                        <span class="n2b-label" style="background: var(--not-color)">NOT</span>
                        <span>ë‹¨ìˆœíˆ ê¸°ì´ˆê¸ˆì•¡ ${data['ê¸°ì´ˆê¸ˆì•¡'].toLocaleString()}ì›ì´ ì»¤ì„œ ì°¸ì—¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤</span>
                    </div>
                    <div class="n2b-item">
                        <span class="n2b-label" style="background: var(--but-color)">BUT</span>
                        <span>ê²½ìŸê°€ ${data['ê²½ìŸê°€'].toLocaleString()}ì› ëŒ€ë¹„ ë‚´ ì›ê°€ ${data['ë‚´ì›ê°€']['í•©ê³„'].toLocaleString()}ì›ì´ íŒë‹¨ ê¸°ì¤€ì´ë‹¤</span>
                    </div>
                    <div class="n2b-item">
                        <span class="n2b-label" style="background: var(--because-color)">BECAUSE</span>
                        <span>${data['ì´ìœ¤'] >= 0 ? 
                            `ì´ìœ¤ ${data['ì´ìœ¤'].toLocaleString()}ì› (${data['ì´ìœ¤ë¥ ']}%)ë¡œ ì°¸ì—¬ ê°€ì¹˜ê°€ ìˆë‹¤` : 
                            `ì´ìœ¤ì´ ${data['ì´ìœ¤'].toLocaleString()}ì›ìœ¼ë¡œ ì†í•´, ì°¸ì—¬ ë¶ˆê°€`}</span>
                    </div>
                </div>
            `;
            
            resultDiv.classList.add('show');
        }

        // ì›ê°€ ì´ˆê¸°í™”
        function resetCost() {
            document.getElementById('basePrice').value = '';
            document.getElementById('bidRate').value = 85;
            document.getElementById('materialDiscount').value = 10;
            document.getElementById('laborDiscount').value = 15;
            document.getElementById('equipmentDiscount').value = 10;
            updateSliderValue('material');
            updateSliderValue('labor');
            updateSliderValue('equipment');
            document.getElementById('costResult').classList.remove('show');
        }

        // N2B íŒì •
        async function analyzeDecision() {
            const basePrice = parseNumber(document.getElementById('decisionBasePrice').value);
            const estimatedCost = parseNumber(document.getElementById('estimatedCost').value);
            
            if (!basePrice || !estimatedCost) {
                alert('ê¸°ì´ˆê¸ˆì•¡ê³¼ ì˜ˆìƒì›ê°€ë¥¼ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }

            const workType = document.getElementById('decisionWorkType').value;
            const minProfitRate = parseFloat(document.getElementById('minProfitRate').value) || 10;

            document.getElementById('decisionLoading').classList.add('show');
            document.getElementById('decisionResult').classList.remove('show');

            try {
                const response = await fetch(`${API_BASE}/api/quick-decision?base_price=${basePrice}&estimated_cost=${estimatedCost}&work_type=${encodeURIComponent(workType)}&min_profit_rate=${minProfitRate}`);
                
                const data = await response.json();
                displayDecisionResult(data);
            } catch (error) {
                console.error('Error:', error);
                // ì˜¤í”„ë¼ì¸ íŒì • (ë°±ì—…)
                const result = analyzeDecisionOffline(basePrice, estimatedCost, minProfitRate);
                displayDecisionResult(result);
            } finally {
                document.getElementById('decisionLoading').classList.remove('show');
            }
        }

        // ì˜¤í”„ë¼ì¸ íŒì • (ë°±ì—…)
        function analyzeDecisionOffline(basePrice, estimatedCost, minProfitRate) {
            const bubbleRate = ((basePrice - estimatedCost) / basePrice * 100);
            const profitRate = ((basePrice - estimatedCost) / estimatedCost * 100);
            
            let score = 50;
            if (bubbleRate >= 25) score += 30;
            else if (bubbleRate >= 20) score += 25;
            else if (bubbleRate >= 15) score += 20;
            else if (bubbleRate >= 10) score += 15;
            else if (bubbleRate >= 5) score += 10;
            
            if (profitRate >= minProfitRate + 10) score += 20;
            else if (profitRate >= minProfitRate + 5) score += 15;
            else if (profitRate >= minProfitRate) score += 10;
            else if (profitRate >= minProfitRate - 5) score += 5;
            else score -= 10;
            
            score = Math.max(0, Math.min(100, score));
            
            let decision, recommendation;
            if (score >= 75) {
                decision = 'ì ê·¹ ì°¸ì—¬';
                recommendation = 'ìˆ˜ìµì„± ë†’ìŒ, ì ê·¹ ì°¸ì—¬ ê¶Œì¥';
            } else if (score >= 60) {
                decision = 'ì°¸ì—¬ ê¶Œì¥';
                recommendation = 'ì ì • ìˆ˜ìµ ì˜ˆìƒ, ì°¸ì—¬ ê³ ë ¤';
            } else if (score >= 45) {
                decision = 'ì¡°ê±´ë¶€ ì°¸ì—¬';
                recommendation = 'ì›ê°€ ì¬ê²€í†  í›„ ì°¸ì—¬ ê²°ì •';
            } else if (score >= 30) {
                decision = 'ì‹ ì¤‘ ê²€í† ';
                recommendation = 'ë¦¬ìŠ¤í¬ ë†’ìŒ, ì‹ ì¤‘í•œ ê²€í†  í•„ìš”';
            } else {
                decision = 'ë¶ˆì°¸ ê¶Œì¥';
                recommendation = 'ìˆ˜ìµì„± ë‚®ìŒ, ë¶ˆì°¸ ê¶Œì¥';
            }

            return {
                decision: decision,
                score: score,
                recommendation: recommendation,
                n2b: {
                    not: `ë‹¨ìˆœíˆ ê¸°ì´ˆê¸ˆì•¡ ${basePrice.toLocaleString()}ì›ì´ ì»¤ì„œ ì°¸ì—¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë‹¤`,
                    but: `ì‹¤ì œì›ê°€ ${estimatedCost.toLocaleString()}ì› ëŒ€ë¹„ ê±°í’ˆë¥  ${bubbleRate.toFixed(1)}%ê°€ íŒë‹¨ ê¸°ì¤€ì´ë‹¤`,
                    because: `ê±°í’ˆë¥ ì´ ${bubbleRate >= 15 ? 'ì¶©ë¶„í•˜ì—¬' : 'ë¶€ì¡±í•˜ì—¬'} ì˜ˆìƒìˆ˜ìµë¥  ${profitRate.toFixed(1)}%${profitRate >= minProfitRate ? 'ë¡œ ì°¸ì—¬ ê°€ì¹˜ê°€ ìˆë‹¤' : 'ë¡œ ë¦¬ìŠ¤í¬ê°€ ìˆë‹¤'}`
                },
                'ë¶„ì„': {
                    'ê¸°ì´ˆê¸ˆì•¡': basePrice,
                    'ì˜ˆìƒì›ê°€': estimatedCost,
                    'ê±°í’ˆë¥ ': bubbleRate.toFixed(1),
                    'ì˜ˆìƒìˆ˜ìµ': basePrice - estimatedCost,
                    'ìˆ˜ìµë¥ ': profitRate.toFixed(1)
                }
            };
        }

        // íŒì • ê²°ê³¼ í‘œì‹œ
        function displayDecisionResult(data) {
            const resultDiv = document.getElementById('decisionResult');
            
            const decisionClass = data.score >= 60 ? 'positive' : 
                                 data.score >= 40 ? 'neutral' : 'negative';
            
            resultDiv.innerHTML = `
                <h3>ğŸ¯ N2B ì°¸ì—¬ íŒì • ê²°ê³¼</h3>
                
                <div class="decision-result ${decisionClass}">
                    <div class="decision-score">${data.score}ì </div>
                    <div class="decision-label">${data.decision}</div>
                    <div class="decision-desc">${data.recommendation}</div>
                </div>

                <div class="n2b-result">
                    <h4 style="margin-bottom: 1rem;">ğŸ“‹ N2B ë¶„ì„</h4>
                    <div class="n2b-item">
                        <span class="n2b-label not">NOT</span>
                        <span class="n2b-text">${data.n2b.not}</span>
                    </div>
                    <div class="n2b-item">
                        <span class="n2b-label but">BUT</span>
                        <span class="n2b-text">${data.n2b.but}</span>
                    </div>
                    <div class="n2b-item">
                        <span class="n2b-label because">BECAUSE</span>
                        <span class="n2b-text">${data.n2b.because}</span>
                    </div>
                </div>

                <div class="strategy-box">
                    <h4>ğŸ“Š í•µì‹¬ ì§€í‘œ</h4>
                    <div class="strategy-grid">
                        <div class="strategy-item">
                            <div class="value">${parseFloat(data['ë¶„ì„']['ê±°í’ˆë¥ ']).toFixed(1)}%</div>
                            <div class="label">ê±°í’ˆë¥ </div>
                        </div>
                        <div class="strategy-item">
                            <div class="value">${parseFloat(data['ë¶„ì„']['ìˆ˜ìµë¥ ']).toFixed(1)}%</div>
                            <div class="label">ì˜ˆìƒ ìˆ˜ìµë¥ </div>
                        </div>
                        <div class="strategy-item">
                            <div class="value">${data['ë¶„ì„']['ì˜ˆìƒìˆ˜ìµ'].toLocaleString()}</div>
                            <div class="label">ì˜ˆìƒ ìˆ˜ìµ (ì›)</div>
                        </div>
                    </div>
                </div>
            `;
            
            resultDiv.classList.add('show');
        }

        // íŒì • ì´ˆê¸°í™”
        function resetDecision() {
            document.getElementById('decisionBasePrice').value = '';
            document.getElementById('estimatedCost').value = '';
            document.getElementById('minProfitRate').value = 10;
            document.getElementById('decisionResult').classList.remove('show');
        }

        // ë‹¨ê°€ ê²€ìƒ‰
        async function searchPrice() {
            const keyword = document.getElementById('priceKeyword').value.trim();
            if (!keyword) {
                alert('ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ì„¸ìš”');
                return;
            }

            document.getElementById('priceLoading').classList.add('show');
            document.getElementById('priceResult').classList.remove('show');

            try {
                const category = document.getElementById('priceCategory').value;
                const response = await fetch(`${API_BASE}/api/price-search`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ keyword: keyword, category: category })
                });
                
                const data = await response.json();
                displayPriceResult(data);
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('priceResult').innerHTML = `
                    <h3>âš ï¸ ì¡°íšŒ ì‹¤íŒ¨</h3>
                    <p>ì¡°ë‹¬ì²­ API ì—°ê²°ì— ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‚˜ì¤‘ì— ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>
                    <p style="color: var(--text-muted); font-size: 0.9rem;">
                        ì¡°ë‹¬ì²­ ê°€ê²©ì •ë³´ëŠ” <a href="https://www.g2b.go.kr" target="_blank">ë‚˜ë¼ì¥í„°</a>ì—ì„œ ì§ì ‘ í™•ì¸í•˜ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
                    </p>
                `;
                document.getElementById('priceResult').classList.add('show');
            } finally {
                document.getElementById('priceLoading').classList.remove('show');
            }
        }

        // ë‹¨ê°€ ê²°ê³¼ í‘œì‹œ
        function displayPriceResult(data) {
            const resultDiv = document.getElementById('priceResult');
            
            let html = `<h3>ğŸ’° ë‹¨ê°€ ê²€ìƒ‰ ê²°ê³¼ (${data.total}ê±´)</h3>`;
            
            if (data['ìì¬ë‹¨ê°€'] && data['ìì¬ë‹¨ê°€'].length > 0) {
                html += `<h4 style="margin-top: 1rem;">ğŸ“¦ ìì¬ë‹¨ê°€</h4>`;
                html += `<table class="cost-table">
                    <tr><th>í’ˆëª…</th><th>ê·œê²©</th><th>ë‹¨ìœ„</th><th>ë‹¨ê°€</th></tr>`;
                data['ìì¬ë‹¨ê°€'].forEach(item => {
                    html += `<tr>
                        <td>${item.name}</td>
                        <td>${item.spec}</td>
                        <td>${item.unit}</td>
                        <td>${item.price.toLocaleString()}ì›</td>
                    </tr>`;
                });
                html += `</table>`;
            }
            
            if (data['ì‹œê³µë‹¨ê°€'] && data['ì‹œê³µë‹¨ê°€'].length > 0) {
                html += `<h4 style="margin-top: 1rem;">ğŸ”§ ì‹œê³µë‹¨ê°€</h4>`;
                html += `<table class="cost-table">
                    <tr><th>ê³µì¢…</th><th>ì„¸ë¶€</th><th>ë‹¨ìœ„</th><th>ë‹¨ê°€</th></tr>`;
                data['ì‹œê³µë‹¨ê°€'].forEach(item => {
                    html += `<tr>
                        <td>${item.name}</td>
                        <td>${item.spec}</td>
                        <td>${item.unit}</td>
                        <td>${item.price.toLocaleString()}ì›</td>
                    </tr>`;
                });
                html += `</table>`;
            }
            
            if (data.total === 0) {
                html += `<p style="padding: 1rem; text-align: center; color: var(--text-muted);">
                    ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ê²€ìƒ‰ì–´ë¥¼ ì‹œë„í•´ë³´ì„¸ìš”.
                </p>`;
            }
            
            resultDiv.innerHTML = html;
            resultDiv.classList.add('show');
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', () => {
            updateSliderValue('material');
            updateSliderValue('labor');
            updateSliderValue('equipment');
        });
    </script>
</body>
</html>
